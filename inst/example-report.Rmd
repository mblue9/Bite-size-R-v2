---
title: "Protein levels in breast cancer cells treated with tamoxifen"
author: "Maria Doyle"
output: html_document
---

## Introduction

Which proteins change in abundance in the breast cancer cell line, MCF-7, with tamoxifen treatment? How do their levels change with treatment time? Answering these questions (at a high level) is the focus of this analysis.

### Packages

We will use the **tidyverse** collection of packages for data import, wrangling and visualization.

```{r load-packages, warning=FALSE, message=FALSE}
library(tidyverse)
```

### Data

The data we're using was generated by CRUK CI scientists ([Papachristou _et al._, Nature Communications 9:2311, 2018](https://pubmed.ncbi.nlm.nih.gov/29899353)).
It is the abundance of proteins in a breast cancer cell line (MCF-7) at
various time points after treatment with the drug tamoxifen, measured using mass spectrometry. In the chunk below we import the CSV file containing the data, skipping the first header row.

```{r message=FALSE}
protein_levels <- read_csv("https://zenodo.org/record/6450144/files/41467_2018_4619_MOESM11_ESM.csv", skip = 1)
```

## Protein levels after treatment with tamoxifen

Let's create a data visualisation that displays the levels for proteins that are decreased (log2fc < -0.75) in the 24h tamoxifen treated sample versus control (veh).

```{r plot-protein-levels, fig.width=10, fig.height=6, message=FALSE}
protein_levels %>%
  filter(`log2FC(24h/veh)` < -0.75) %>%
  select(accession = `Uniprot Accession`, gene = `Gene Name`, vehicle.rep01:tam.24h.rep04) %>%
  pivot_longer(vehicle.rep01:tam.24h.rep04, names_to = "sample", values_to = "protein_level") %>%
  mutate(sample = str_replace(sample, "vehicle", "vehicle.24h")) %>%
  separate(sample, into = c("treatment", "time", "replicate")) %>%
  mutate(group = str_sub(treatment, 1, 3)) %>%
  mutate(group = str_c(group, time)) %>%
  mutate(group = as_factor(group)) %>%
  ggplot(mapping = aes(x = group, y = protein_level, fill = group)) +
  geom_boxplot() +
  geom_jitter(width = 0.15) +
  facet_wrap(vars(gene), scales = "free_y", ncol = 3) +
  labs(
    title = "Protein levels in MCF-7 treated with tamoxifen",
    y = "Protein level",
    x = ""
  )
```

1. Click Knit to generate a html report containing the plot.  
2. We can easily change which proteins are being plotted by changing the threshold the code above `filter`s for. Try changing the filter to `> 0.75`  then Knit again.

## References

1.  Cancer Research UK Cambridge Institute, University of Cambridge "Introduction to R for Cancer Scientists"
2.  Mine Cetinkaya-Rundel "Data Science in a Box" 
